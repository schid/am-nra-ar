YUI.add("vdgm",function(e,t){function n(){n.superclass.constructor.apply(this,arguments)}n.NAME="vdgm",n.ATTRS={},e.namespace("external").VDGM=e.Base.create("vdgm",e.Widget,[e.WidgetChild],{initializer:function(e){this.isLocal=e.isLocal},players:[],newVideoPlayer:function(t){var n=new e.Vdgm.VideoModal({host:t.host}),r=new e.Vdgm.VideoPlayer(t.videoConfig),i=e.one(t.targetNode),s=this,o="/yui/build/videoplayer/assets/",u=t.host+"/vdgmvideoplayer/videoplayer/assets/",a=s.isLocal?o:u;return r._assetPath=a,r.add(n),r.render(i.one(".main-video")),n.render(i.one(".main-video")),e.after("interact",function(e){}),s.players.push(r),r}}),YUI.add("swfobject",function(e){
/*!	SWFObject v2.2 <http://code.google.com/p/swfobject/> 
	is released under the MIT License <http://www.opensource.org/licenses/mit-license.php> 
*/
;var t=function(){function k(){if(w)return;try{var e=f.getElementsByTagName("body")[0].appendChild(z("span"));e.parentNode.removeChild(e)}catch(t){return}w=!0;var n=h.length;for(var r=0;r<n;r++)h[r]()}function L(e){w?e():h[h.length]=e}function A(t){if(typeof a.addEventListener!=e)a.addEventListener("load",t,!1);else if(typeof f.addEventListener!=e)f.addEventListener("load",t,!1);else if(typeof a.attachEvent!=e)W(a,"onload",t);else if(typeof a.onload=="function"){var n=a.onload;a.onload=function(){n(),t()}}else a.onload=t}function O(){c?M():_()}function M(){var t=f.getElementsByTagName("body")[0],r=z(n);r.setAttribute("type",s);var i=t.appendChild(r);if(i){var o=0;(function(){if(typeof i.GetVariable!=e){var n=i.GetVariable("$version");n&&(n=n.split(" ")[1].split(","),N.pv=[parseInt(n[0],10),parseInt(n[1],10),parseInt(n[2],10)])}else if(o<10){o++,setTimeout(arguments.callee,10);return}t.removeChild(r),i=null,_()})()}else _()}function _(){var t=p.length;if(t>0)for(var n=0;n<t;n++){var r=p[n].id,i=p[n].callbackFn,s={success:!1,id:r};if(N.pv[0]>0){var o=U(r);if(o)if(X(p[n].swfVersion)&&!(N.wk&&N.wk<312))$(r,!0),i&&(s.success=!0,s.ref=D(r),i(s));else if(p[n].expressInstall&&P()){var u={};u.data=p[n].expressInstall,u.width=o.getAttribute("width")||"0",u.height=o.getAttribute("height")||"0",o.getAttribute("class")&&(u.styleclass=o.getAttribute("class")),o.getAttribute("align")&&(u.align=o.getAttribute("align"));var a={},f=o.getElementsByTagName("param"),l=f.length;for(var c=0;c<l;c++)f[c].getAttribute("name").toLowerCase()!="movie"&&(a[f[c].getAttribute("name")]=f[c].getAttribute("value"));H(u,a,r,i)}else B(o),i&&i(s)}else{$(r,!0);if(i){var h=D(r);h&&typeof h.SetVariable!=e&&(s.success=!0,s.ref=h),i(s)}}}}function D(t){var r=null,i=U(t);if(i&&i.nodeName=="OBJECT")if(typeof i.SetVariable!=e)r=i;else{var s=i.getElementsByTagName(n)[0];s&&(r=s)}return r}function P(){return!E&&X("6.0.65")&&(N.win||N.mac)&&!(N.wk&&N.wk<312)}function H(t,n,r,i){E=!0,y=i||null,b={success:!1,id:r};var s=U(r);if(s){s.nodeName=="OBJECT"?(m=j(s),g=null):(m=s,g=r),t.id=o;if(typeof t.width==e||!/%$/.test(t.width)&&parseInt(t.width,10)<310)t.width="310";if(typeof t.height==e||!/%$/.test(t.height)&&parseInt(t.height,10)<137)t.height="137";f.title=f.title.slice(0,47)+" - Flash Player Installation";var u=N.ie&&N.win?"ActiveX":"PlugIn",l="MMredirectURL="+a.location.toString().replace(/&/g,"%26")+"&MMplayerType="+u+"&MMdoctitle="+f.title;typeof n.flashvars!=e?n.flashvars+="&"+l:n.flashvars=l;if(N.ie&&N.win&&s.readyState!=4){var c=z("div");r+="SWFObjectNew",c.setAttribute("id",r),s.parentNode.insertBefore(c,s),s.style.display="none",function(){s.readyState==4?s.parentNode.removeChild(s):setTimeout(arguments.callee,10)}()}F(t,n,r)}}function B(e){if(N.ie&&N.win&&e.readyState!=4){var t=z("div");e.parentNode.insertBefore(t,e),t.parentNode.replaceChild(j(e),t),e.style.display="none",function(){e.readyState==4?e.parentNode.removeChild(e):setTimeout(arguments.callee,10)}()}else e.parentNode.replaceChild(j(e),e)}function j(e){var t=z("div");if(N.win&&N.ie)t.innerHTML=e.innerHTML;else{var r=e.getElementsByTagName(n)[0];if(r){var i=r.childNodes;if(i){var s=i.length;for(var o=0;o<s;o++)(i[o].nodeType!=1||i[o].nodeName!="PARAM")&&i[o].nodeType!=8&&t.appendChild(i[o].cloneNode(!0))}}}return t}function F(t,r,i){var o,u=U(i);if(N.wk&&N.wk<312)return o;if(u){typeof t.id==e&&(t.id=i);if(N.ie&&N.win){var a="";for(var f in t)t[f]!=Object.prototype[f]&&(f.toLowerCase()=="data"?r.movie=t[f]:f.toLowerCase()=="styleclass"?a+=' class="'+t[f]+'"':f.toLowerCase()!="classid"&&(a+=" "+f+'="'+t[f]+'"'));var l="";for(var c in r)r[c]!=Object.prototype[c]&&(l+='<param name="'+c+'" value="'+r[c]+'" />');u.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+a+">"+l+"</object>",d[d.length]=t.id,o=U(t.id)}else{var h=z(n);h.setAttribute("type",s);for(var p in t)t[p]!=Object.prototype[p]&&(p.toLowerCase()=="styleclass"?h.setAttribute("class",t[p]):p.toLowerCase()!="classid"&&h.setAttribute(p,t[p]));for(var v in r)r[v]!=Object.prototype[v]&&v.toLowerCase()!="movie"&&I(h,v,r[v]);u.parentNode.replaceChild(h,u),o=h}}return o}function I(e,t,n){var r=z("param");r.setAttribute("name",t),r.setAttribute("value",n),e.appendChild(r)}function q(e){var t=U(e);t&&t.nodeName=="OBJECT"&&(N.ie&&N.win?(t.style.display="none",function(){t.readyState==4?R(e):setTimeout(arguments.callee,10)}()):t.parentNode.removeChild(t))}function R(e){var t=U(e);if(t){for(var n in t)typeof t[n]=="function"&&(t[n]=null);t.parentNode.removeChild(t)}}function U(e){var t=null;try{t=f.getElementById(e)}catch(n){}return t}function z(e){return f.createElement(e)}function W(e,t,n){e.attachEvent(t,n),v[v.length]=[e,t,n]}function X(e){var t=N.pv,n=e.split(".");return n[0]=parseInt(n[0],10),n[1]=parseInt(n[1],10)||0,n[2]=parseInt(n[2],10)||0,t[0]>n[0]||t[0]==n[0]&&t[1]>n[1]||t[0]==n[0]&&t[1]==n[1]&&t[2]>=n[2]}function V(t,r,i,s){if(N.ie&&N.mac)return;var o=f.getElementsByTagName("head")[0];if(!o)return;var u=i&&typeof i=="string"?i:"screen";s&&(S=null,x=null);if(!S||x!=u){var a=z("style");a.setAttribute("type","text/css"),a.setAttribute("media",u),S=o.appendChild(a),N.ie&&N.win&&typeof f.styleSheets!=e&&f.styleSheets.length>0&&(S=f.styleSheets[f.styleSheets.length-1]),x=u}N.ie&&N.win?S&&typeof S.addRule==n&&
S.addRule(t,r):S&&typeof f.createTextNode!=e&&S.appendChild(f.createTextNode(t+" {"+r+"}"))}function $(e,t){if(!T)return;var n=t?"visible":"hidden";w&&U(e)?U(e).style.visibility=n:V("#"+e,"visibility:"+n)}function J(t){var n=/[\\\"<>\.;]/,r=n.exec(t)!=null;return r&&typeof encodeURIComponent!=e?encodeURIComponent(t):t}var e="undefined",n="object",r="Shockwave Flash",i="ShockwaveFlash.ShockwaveFlash",s="application/x-shockwave-flash",o="SWFObjectExprInst",u="onreadystatechange",a=window,f=document,l=navigator,c=!1,h=[O],p=[],d=[],v=[],m,g,y,b,w=!1,E=!1,S,x,T=!0,N=function(){var t=typeof f.getElementById!=e&&typeof f.getElementsByTagName!=e&&typeof f.createElement!=e,o=l.userAgent.toLowerCase(),u=l.platform.toLowerCase(),h=u?/win/.test(u):/win/.test(o),p=u?/mac/.test(u):/mac/.test(o),d=/webkit/.test(o)?parseFloat(o.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,v=!1,m=[0,0,0],g=null;if(typeof l.plugins!=e&&typeof l.plugins[r]==n)g=l.plugins[r].description,g&&(typeof l.mimeTypes==e||!l.mimeTypes[s]||!!l.mimeTypes[s].enabledPlugin)&&(c=!0,v=!1,g=g.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),m[0]=parseInt(g.replace(/^(.*)\..*$/,"$1"),10),m[1]=parseInt(g.replace(/^.*\.(.*)\s.*$/,"$1"),10),m[2]=/[a-zA-Z]/.test(g)?parseInt(g.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof a.ActiveXObject!=e)try{var y=new ActiveXObject(i);y&&(g=y.GetVariable("$version"),g&&(v=!0,g=g.split(" ")[1].split(","),m=[parseInt(g[0],10),parseInt(g[1],10),parseInt(g[2],10)]))}catch(b){}return{w3:t,pv:m,wk:d,ie:v,win:h,mac:p}}(),C=function(){if(!N.w3)return;(typeof f.readyState!=e&&f.readyState=="complete"||typeof f.readyState==e&&(f.getElementsByTagName("body")[0]||f.body))&&k(),w||(typeof f.addEventListener!=e&&f.addEventListener("DOMContentLoaded",k,!1),N.ie&&N.win&&(f.attachEvent(u,function(){f.readyState=="complete"&&(f.detachEvent(u,arguments.callee),k())}),a==top&&function(){if(w)return;try{f.documentElement.doScroll("left")}catch(e){setTimeout(arguments.callee,0);return}k()}()),N.wk&&function(){if(w)return;if(!/loaded|complete/.test(f.readyState)){setTimeout(arguments.callee,0);return}k()}(),A(k))}(),K=function(){N.ie&&N.win&&window.attachEvent("onunload",function(){var e=v.length;for(var n=0;n<e;n++)v[n][0].detachEvent(v[n][1],v[n][2]);var r=d.length;for(var i=0;i<r;i++)q(d[i]);for(var s in N)N[s]=null;N=null;for(var o in t)t[o]=null;t=null})}();return{registerObject:function(e,t,n,r){if(N.w3&&e&&t){var i={};i.id=e,i.swfVersion=t,i.expressInstall=n,i.callbackFn=r,p[p.length]=i,$(e,!1)}else r&&r({success:!1,id:e})},getObjectById:function(e){if(N.w3)return D(e)},embedSWF:function(t,r,i,s,o,u,a,f,l,c){var h={success:!1,id:r};N.w3&&!(N.wk&&N.wk<312)&&t&&r&&i&&s&&o?($(r,!1),L(function(){i+="",s+="";var p={};if(l&&typeof l===n)for(var d in l)p[d]=l[d];p.data=t,p.width=i,p.height=s;var v={};if(f&&typeof f===n)for(var m in f)v[m]=f[m];if(a&&typeof a===n)for(var g in a)typeof v.flashvars!=e?v.flashvars+="&"+g+"="+a[g]:v.flashvars=g+"="+a[g];if(X(o)){var y=F(p,v,r);p.id==r&&$(r,!0),h.success=!0,h.ref=y}else{if(u&&P()){p.data=u,H(p,v,r,c);return}$(r,!0)}c&&c(h)})):c&&c(h)},switchOffAutoHideShow:function(){T=!1},ua:N,getFlashPlayerVersion:function(){return{major:N.pv[0],minor:N.pv[1],release:N.pv[2]}},hasFlashPlayerVersion:X,createSWF:function(e,t,n){return N.w3?F(e,t,n):undefined},showExpressInstall:function(e,t,n,r){N.w3&&P()&&H(e,t,n,r)},removeSWF:function(e){N.w3&&q(e)},createCSS:function(e,t,n,r){N.w3&&V(e,t,n,r)},addDomLoadEvent:L,addLoadEvent:A,getQueryParamValue:function(e){var t=f.location.search||f.location.hash;if(t){/\?/.test(t)&&(t=t.split("?")[1]);if(e==null)return J(t);var n=t.split("&");for(var r=0;r<n.length;r++)if(n[r].substring(0,n[r].indexOf("="))==e)return J(n[r].substring(n[r].indexOf("=")+1))}return""},expressInstallCallback:function(){if(E){var e=U(o);e&&m&&(e.parentNode.replaceChild(m,e),g&&($(g,!0),N.ie&&N.win&&(m.style.display="block")),y&&y(b)),E=!1}}}}();e.swfobject=t,e.swfobject.registerCallback=function(t,n){e.SWF._instances[t]=n},e.SWF={_instances:[],eventHandler:function(t,n){var r=e.SWF._instances[t];r&&typeof r=="function"&&r(n)}}},"0.0.1",{requires:[]})},"0.0.1",{use:["swfobject","node-event-simulate"],requires:["node","widget","videoplayer","videomodal","json","json-stringify","io","array-extras","share"],skinnable:!0}),YUI.add("videomodal",function(e,t){function n(){n.superclass.constructor.apply(this,arguments)}n.NAME="videomodal",n.ATTRS={},e.namespace("Vdgm").VideoModal=e.Base.create("videomodal",e.Widget,[e.WidgetChild],{MODAL_DURATION:8,VIDEO_PAUSED_EVENT:"video_paused",VIDEO_ENDED_EVENT:"video_ended",TRIGGER_VIDEO_STOP:"video_player_stop",TRIGGER_VIDEO_PLAY:"video_player_play",BOUNDING_TEMPLATE:'<div id="video-modal"/>',CONTENT_TEMPLATE:'<div class="video-headline now-playing">NOW PLAYING</div><div class="video-headline related-videos-headline">RELATED VIDEOS</div><div class="video-paused play-video"><p class="video-headline vdgm-icon-pause icon-pause"></p></div><div id="video-timer-message"><p>NEXT VIDEO WILL BEGIN IN: <span id="video-timer"></span></p></div><div id="video-modal-control"><div id="control-buttons"><div class="control"><div id="play-video-control" class="video-control-button play-video"></div></div><div class="control"><div id="close-video-control" class="video-control-button stop-video"><span class="vdgm-icon-stop icon-stop" ></span></div></div><div class="control"><div id="next-video-control" class="video-control-button next-video">Play Next Video</div></div></div><div id="share-items"><p>SHARE</p><div id="facebook-video-control" class="vdgm-shareable"><span class="vdgm-icon-facebook icon-facebook" ></span></div><div id="twitter-video-control" class="vdgm-shareable"><span class="vdgm-icon-twitter icon-twitter" ></span></div><div id="email-video-control" class="vdgm-shareable"><span class="vdgm-icon-share icon-share"></span></div></div></div>',templates:{LIST:'<ul class="related-videos"></ul>',LINK:"://{host}/home/video/{slug}",RELATED_ITEM:'<li data-itemslug="{slug}" class="related-video related-video-{index}"><a href="{link}" target="{target}"><div class ="list-item-image"><img  src="{imageURL}"/><p>{title}</p></div></a></li>'
,REPLAY_BUTTON:'<span class="vdgm-icon-spinner icon-spinner"></span>',PLAY_BUTTON:'<span class="vdgm-icon-play icon-play"></span>'},relatedGroups:[],selectors:{relatedVideoItem:".related-video",lastRelatedItem:".lastRelatedItem",prev:".video-prev",next:".video-next",modal:"#video-modal",playButton:"#play-video-control",playClass:"play-video",stopClass:"stop-video",closeButton:"#close-video-control",pausedHeadline:".video-paused",relatedVideos:".related-videos",relatedVideoContainer:"#related-video-container",timer:"#video-timer",embed:"#embed-player"},events:{".play-video":{click:"handleControlClick"},".stop-video":{click:"handleControlClick"},".next-video":{click:"playNextVideo"}},_closeAfterEnded:!0,_hasShareItems:!0,initializer:function(e){var t=this,n=t.get("boundingBox");e.closeAfterEnded?t._closeAfterEnded=e._closeAfterEnded:this.get("boundingBox").addClass("no-close"),e.hasShareItems||this.get("boundingBox").addClass("no-share"),e.hasStopButton||this.get("boundingBox").addClass("no-stop"),this.on("parentChange",function(n){console.log(n+" "+n.parent),t._parent=n.newVal,t.initEvents(e)});for(var r in this.events)for(var i in t.events[r])n.delegate(i,t[t.events[r][i]],r,this)},initEvents:function(e){var t=this;container=t.get("boundingBox"),t._parent.after("pause",function(n){t._handleModal(e,t.VIDEO_PAUSED_EVENT),t._initRelated(e,t.VIDEO_PAUSED_EVENT)}),t._parent.after("stop",function(e){t.get("boundingBox").remove(),t._parent.remove(this)}),t._parent.after("ended",function(n){t._handleModal(e,t.VIDEO_ENDED_EVENT),t._initRelated(e,t.VIDEO_ENDED_EVENT)}),t._parent.after("play",function(e){t.get("boundingBox").removeClass("active"),t.get("boundingBox").ancestor().removeClass("modal-control-active")})},setZero:function(e){return e<0?0:e},cycleItems:function(t){if(t=="fwd"&&this.currentGroup+1==this.relatedGroups.length||t=="back"&&this.currentGroup-1==-1)return;var n=this;itemIndex=0,container=e.one(n.selectors.modal),relatedVideoList=container.one(n.selectors.relatedVideos),nextGroup=n.relatedGroups[t==="fwd"?n.currentGroup+1:n.setZero(n.currentGroup-1)],nextIndex=t==="fwd"?n.currentGroup+1:n.setZero(n.currentGroup-1),nextIndex>=0&&!n.transitioning&&(n._repetition=8,n.transitioning=!0,n.relatedGroups[n.currentGroup].hide("fadeOut",{},function(){nextGroup.show("fadeIn",{},function(){n.currentGroup=nextIndex,n.transitioning=!1})}))},_initRelated:function(t,n){var r=this._parent.model.related_videos,i=this,s=this.get("boundingBox").ancestor(),o=this.get("boundingBox"),u=0,a=0,f=e.Node.create(this.templates.LIST),l="",c={},h={};i.transitioning=!1,i.totalGroups=0,i.maxRelated=Math.floor(o.get("offsetWidth")/210),this.embed=this._parent.model.embed;if(!r){s.one(".related-videos-headline").addClass("hide"),s.one("#next-video-control").addClass("hide"),s.one("#video-timer-message").addClass("hide");return}for(var p=0;p<Number(r.length);p++){u=p,l=r[u].link?r[u].link:e.Lang.sub(i.templates.LINK,{host:t.host,slug:r[u].slug}),subcfg={slug:r[u].slug,index:u,link:l,imageURL:i._getThumbImage(r[u]),target:i.embed?"_blank":"_self",title:r[u].title};var c=e.Lang.sub(i.templates.RELATED_ITEM,subcfg),d=e.Node.create(c);p||(i.firstRelated=d),f.appendChild(d)}if(!i.get("boundingBox").one(i.selectors.relatedVideos)){i.get("boundingBox").appendChild(f);var v=i.get("boundingBox").one(i.selectors.relatedVideos).getDOMNode(),m=jQuery(v);m.perfectScrollbar({wheelPropagation:!0})}},_getThumbImage:function(e){var t,n=this;return e.images&&e.images[285]?t=e.images[285].imageUrl:t=e.images[263]?e.images[263].imageUrl:"",t},_handleModal:function(e,t){if(this.get("boundingBox").hasClass("active"))return;var n=this.get("boundingBox").ancestor(),r=this,i=this._parent.model,s=this.get("boundingBox"),o=this.get("boundingBox").one(r.selectors.playButton),u=this.get("boundingBox").one(r.selectors.closeButton),a={};r.type=t,this.get("boundingBox").ancestor().addClass("modal-control-active"),r.type&&(this.get("boundingBox").removeClass("video_paused"),this.get("boundingBox").removeClass("video_ended"),this.get("boundingBox").addClass(r.type)),r._repetition=r.MODAL_DURATION,r.type===r.VIDEO_PAUSED_EVENT?(o.setHTML(r.templates.PLAY_BUTTON),r.isPaused=!0):r.type===r.VIDEO_ENDED_EVENT&&(o.setHTML(r.templates.REPLAY_BUTTON),i.related_videos&&r._setTimer()),r.fbShare=s.one("#facebook-video-control"),r.fbShare.setAttribute("data-shareid","facebook:video:"+i.id),r.twitterShare=s.one("#twitter-video-control"),r.twitterShare.setAttribute("data-shareid","twitter:video:"+i.id),r.emailShare=s.one("#email-video-control"),r.emailShare.setAttribute("data-shareid","email:video:"+i.id),this.get("boundingBox").addClass("active")},handleControlClick:function(e){var t=this,n=t.get("boundingBox");control=e.currentTarget;if(control.hasClass(t.selectors.playClass))t.type===t.VIDEO_ENDED_EVENT&&(t._repetition=t.MODAL_DURATION,window.clearInterval(t.interval)),t._parent.play();else if(control.hasClass(t.selectors.stopClass)){t._parent.stop(),window.clearInterval(t.interval);return}n.removeClass("active")},playNextVideo:function(e){this.firstRelated.one("a").simulate("click")},closeModal:function(){var e=this;e.get("boundingBox").removeClass("active")},related:{},_setCurrentTime:function(e){var t=this._swf.getDOMNode();t.setCurrentTime(e)},_handleTimer:function(){var e=this,t=this.get("boundingBox"),n=t.one(e.selectors.timer);e._repetition>0?(e._repetition=e._repetition-1,n.setHTML(e._repetition)):(window.clearInterval(e.interval),e.playNextVideo(),e._repetition=e.MODAL_DURATION)},_repetition:0,_setTimer:function(){var e=this;e.interval=window.setInterval(function(){e._handleTimer()},1e3)}}),e.Vdgm.app&&e.augment(n,e.Vdgm.Logger)},"0.0.1",{requires:["node-event-html5","widget","vdgm-logr","event-synthetic","widget-child"],skinnable:!0}),YUI.add("videoplayer",function(e,t){function n(){n.superclass.constructor.apply(this,arguments)}n.ATTRS={},n.NAME="videoPlayer",n.POSTER_TEMPLATE='<div id="poster"><div id="poster-container"><div id="html-poster-stop" class="vdgm-icon-stop icon-stop"></div><div id="html-poster-play" class="vdgm-icon-play icon-play"></div></div><img src="{poster_url}"></div>'
,n.HTML_VIDEO_TEMPLATE='<video controls preload="auto"><source src="{videoUrl}" type="video/mp4"></video>',n.ANDROID_VIDEO_TEMPLATE='<video controls preload="auto"><source src="{videoUrl}" type="video/mp4"></video>',n.GET_FLASH_TEMPLATE='<div class="no-flash"><p><a href="http://get.adobe.com/flashplayer/">Please install <strong>Adobe Flash Player</strong> to view this content.</a></p></div>',e.namespace("Vdgm").VideoPlayer=e.Base.create("videoPlayer",e.Widget,[e.WidgetParent,e.WidgetChild],{_assetPath:"@ASSETPATH@",_techs:{flash:{renderUI:"_renderFlashVideo",bindUI:"_bindFlashVideo",play:"_playFlashVideo",pause:"_pauseFlashVideo",stop:"_stopFlashVideo",destructor:"_destroyFlashVideo",remove:"_removeFlashVideo"},html:{renderUI:"_renderHtmlVideo",bindUI:"_bindHtmlVideo",play:"_playHtmlVideo",pause:"_pauseHtmlVideo",stop:"_stopHtmlVideo",destructor:"_destroyHtmlVideo",remove:"_removeHtmlVideo"}},_percentPlayed:0,toggleLarge:function(){this.fire("togglelargeview")},initializer:function(t){var n=this;this.model=t.model,this.host=t.host,this.f4mhost=t.f4mhost?t.f4mhost:null,this.flashLiveStream=t.settings.flash,this.htmlLiveStream=t.settings.html,this.tintColor=t.settings.tintColor,this.tech=t.tech||this.getTech(e.UA),this.type=this.model.type,this.embed=this.model.embed,this.duration=this.model.duration?this.model.duration:0,this.meta=this.model.meta?this.model.meta:[],n.isPaused=!1,n.started=!1,this.mapTech(),this.on("destroy",this.destructor,this),t.autoplay||(n._autoplay=!1)},getTech:function(t){var n=function(){return typeof ActiveXObject!="undefined"?typeof navigator.plugins=="undefined"||navigator.plugins.length==0?!!(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")):navigator.plugins["Shockwave Flash"]:typeof navigator.plugins=="undefined"||navigator.plugins.length==0?!1:navigator.plugins["Shockwave Flash"]};return e.UA.flashMajor!=null||n()?"flash":"html"},getVideo:function(t){return e.Array.filter(this.model.videos,function(e){return e.type===t})[0]},mapTech:function(){this._mapToTech("renderUI"),this._mapToTech("bindUI"),this._mapToTech("play"),this._mapToTech("pause"),this._mapToTech("stop"),this._mapToTech("destructor"),this._mapToTech("remove")},_mapToTech:function(e){var t=this;t[e]=function(){t[t._techs[t.tech][e]].call(t,arguments)}},_video:null,_renderHtmlVideo:function(){var t,r=n.HTML_VIDEO_TEMPLATE,i=this.get("contentBox");this.contentBox="contentBox",this.timeIterator=0,this.model.type=="live"?t={videoUrls:{html:""}}:this.model.type=="archive"?t={videoUrls:{html:e.Lang.sub(n.ARCHIVE_HTML_VIDEO_TEMPLATE,{videoPath:this.model.slug})}}:t=this.getVideo("hd")?this.getVideo("hd"):this.getVideo("ios").videoUrls.ios,t||(t=this.getVideo("mobhigh")),t||(t=this.getVideo("high")),this._poster=i.appendChild(e.Lang.sub(n.POSTER_TEMPLATE,{poster_url:this._getPosterImage()})),this._video=i.appendChild(e.Lang.sub(r,{videoUrl:t})),this._poster.one("#html-poster-stop").once("click",function(){this.stop()},this),this._poster.one("#html-poster-play").once("click",function(){this._video.invoke("play"),this._poster.remove(!0)},this)},_addDescriptionCloseButton:function(){var t=this,n=e.one("#embed-player"),r=n.one("#control-buttons"),i=e.Node.create('<div class="vdgm-icon-cancel-circle"></div>');n.one(".vdgm-sharebar").prepend(i),i.detach("click"),i.on("click",function(){t._track("VideoDescriptionClosed"),t.isPaused==1&&t.started&&t.play(),n.replaceClass("info-active","info-inactive"),n.one(".vdgm-sharebar").one(".vdgm-icon-cancel-circle").remove(),t._addDescriptionButton()})},_addDescriptionButton:function(){var t=this,n=e.one("#embed-player"),r=e.Node.create('<div class="vdgm-icon-info"></div>');n.one(".vdgm-sharebar").prepend(r),r.detach("click"),r.on("click",function(e){t._track("VideoDescriptionOpened"),n.one(".vdgm-icon-info").remove(),t._addDescriptionCloseButton(),n.replaceClass("info-inactive","info-active"),t.isPaused==0&&t.started&&t.pause()})},_bindHtmlVideo:function(){this._video.on("play",this._htmlEventHandler,this),this._video.on("pause",this._htmlEventHandler,this),this._video.on("ended",this._htmlEventHandler,this),this._video.on("timeupdate",this._htmlEventHandler,this),this._video.on("seeked",this._htmlEventHandler,this)},_htmlEventHandler:function(e){var t=this["_html_"+e.type];typeof t=="function"&&t.call(this,e)},_html_timeupdate:function(e){var t=this._video.getDOMNode(),n=t.currentTime;if(this.meta&&this.meta.length>0&&this.meta.length>this.timeIterator){var r=Number(this.meta[this.timeIterator].offset);n>r&&(this.fire("updateMeta",{currentTime:n,meta:this.meta}),this.timeIterator++)}this._percentPlayed<25?n/this.duration>=.25&&(this._track("PercentPlayed25"),this._percentPlayed=25):this._percentPlayed<50?n/this.duration>=.5&&(this._track("PercentPlayed50"),this._percentPlayed=50):this._percentPlayed<75?n/this.duration>=.75&&(this._track("PercentPlayed75"),this._percentPlayed=75):this._percentPlayed<90&&n/this.duration>=.9&&(this._track("PercentPlayed90"),this._percentPlayed=90),this._loadStarted||(this.model.timeoffset&&(this._video.getDOMNode().currentTime=Number(this.model.timeoffset),this.fire("updateMeta",{currentTime:Number(this.model.timeoffset),meta:this.meta})),this._loadStarted=!0)},_html_seeked:function(e){var t=this._video.getDOMNode(),n=t.currentTime;this.fire("updateMeta",{currentTime:n,meta:this.meta}),this.timeIterator=0},_html_play:function(e){this._track("Start"),this.fire("play"),this.get("contentBox").addClass("html-active"),this.isPaused=!1,this.started=!0,this._video.setAttribute("controls","true"),this._html_play=function(e){this.get("contentBox").addClass("html-active"),this._video.setAttribute("controls","true"),this.fire("play")}},_html_pause:function(e){this._video.removeAttribute("controls");var t=this,n=this._video.get("ended"),r=this.get("contentBox");n||(this._track("Pause"),this.fire("pause")),r.removeClass("html-active")},_html_ended:function(e){this._track("Complete"),this.fire("ended"),this._percentPlayed=0},_playHtmlVideo:function(){
var e=this;e.isPaused=!1,e.started=!0,this._video.setAttribute("controls","true"),this._video.invoke("play")},_pauseHtmlVideo:function(){var e=arguments[0],t=arguments[0]?arguments[0][0]:!1,n=this;this.isPaused=!0,this._video.invoke("pause")},_stopHtmlVideo:function(){var e=this;this._video.invoke("pause"),this.type=="live"&&this.model.set("userstopped",!0),this._percentPlayed=0,this.fire("stop"),this._track("Stop")},_destroyHtmlVideo:function(){this.model.clear()},_removeHtmlVideo:function(){},_track:function(t,n){var r=this;slug=r.model.slug,videoCategory="VODVideo",n=n||{},this.embed==1?(videoCategory="EmbedVideo",this.type==="live"?videoCategory="EmbedLiveVideo":this.type==="archive"&&(videoCategory="EmbedArchiveVideo")):this.type==="live"?videoCategory="LiveVideo":this.type==="archive"&&(videoCategory="ArchiveVideo"),e.fire("interact",e.merge(n,{category:videoCategory,action:t,label:slug}))},_swf:null,_getGlobalCallback:function(t){var n=this,r="Env.Vdgm.VideoPlayer",i=e.namespace.call(YUI,r);return i[t]=function(t,r,i){r=="onJavaScriptBridgeCreated"&&(n.player=document.getElementById(t),n.playerNode=e.one("#"+t)),n["_flash_"+r]&&n["_flash_"+r].call(n,i),n["_flash_"+t]&&n["_flash_"+t].call(n,i)},"YUI."+r+"."+t},_flash_progress:function(e){this.fire("progress")},_flash_onJavaScriptBridgeCreated:function(e){},_flash_timeChange:function(e){var t=e.currentTime;this.model.timeoffset&&(t+=this.model.timeoffset);if(this.meta&&this.meta.length>0&&this.meta.length>this.timeIterator){var n=Number(this.meta[this.timeIterator].offset);t>n&&(this.fire("updateMeta",{currentTime:t,meta:this.meta}),this.timeIterator++)}this._percentPlayed<25?t/this.duration>=.25&&(this._track("PercentPlayed25"),this._percentPlayed=25):this._percentPlayed<50?t/this.duration>=.5&&(this._track("PercentPlayed50"),this._percentPlayed=50):this._percentPlayed<75?t/this.duration>=.75&&(this._track("PercentPlayed75"),this._percentPlayed=75):this._percentPlayed<90&&t/this.duration>=.9&&(this._track("PercentPlayed90"),this._percentPlayed=90);if(!this._loadStarted){var r=this._swf.getDOMNode(),i=this.model.get("timeoffset")?Number(this.model.get("timeoffset")):0;i!=0&&this._setCurrentTime(i),this._loadStarted=!0}},_flash_seeked:function(e){var t=this._swf.getDOMNode(),n=t.getCurrentTime();this.model.timeoffset&&(n+=this.model.timeoffset),this.fire("updateMeta",{currentTime:n,meta:this.meta}),this.timeIterator=0},_playPreroll:function(){var e=this;this._preroll.shown=!0,this.player.displayAd({id:"preroll",url:this._preroll.src,hideScrubBarWhilePlayingAd:!0,pauseMainMediaWhilePlayingAd:!0,resumePlaybackAfterAd:!0,onComplete:e._getGlobalCallback(this.player._yuid)})},_flash_playing:function(e){this._track("Start"),this.fire("play");var t=this;t.isPaused=!1,t.started=!0,this._preroll&&!this._preroll.shown&&this._playPreroll(),this._flash_playing=function(e){var t=this;t.isPaused=!1,t.started=!0,this.fire("play"),this._preroll&&!this._preroll.shown&&this._playPreroll()}},_flash_paused:function(e){if(this._preroll&&this._preroll.shown&&!this._preroll.complete)return;if(this._postroll&&this._postroll.shown&&!this._postroll.complete)return;this.fire("pause"),this._track("Pause")},_flash_stopVideo:function(e){this._track("Stop"),this.fire("stop"),this._percentPlayed=0,this.type=="live"&&this.model.set("userstopped",!0),this.stop()},_flash_mediaSize:function(e){},_flash_error:function(e){this._percentPlayed=0,this.stop()},_flash_complete:function(e){var t=this;if(this._postroll){if(this._postroll.shown&&this._postroll.complete){this._percentPlayed=0,this._track("Complete"),this.fire("ended");return}this._postroll.shown=!0,this.player.displayAd({id:"postroll",url:this._postroll.src,hideScrubBarWhilePlayingAd:!0,pauseMainMediaWhilePlayingAd:!0,onComplete:t._getGlobalCallback(this.player._yuid)})}else this._percentPlayed=0,this._track("Complete"),this.fire("ended")},_flash_preroll:function(e){this._preroll.complete=!0},_flash_postroll:function(e){this._postroll.complete=!0},_flash_toggleLargeVideo:function(e){this.toggleLarge()},_loadStarted:!1,_getPosterImage:function(){var t,n=this,r=n.f4mhost?n.f4mhost:n.host;return e.Vdgm.app?t=n.model.images?n.model.images[285].imageUrl:"":t=r+(n.model.images[1140]?n.model.images[1140].imageUrl:""),t},_autoplay:self.embed!=1,_renderFlashVideo:function(){var t=this,n=this.type+"-f4m/"+t.model.slug,r=t._assetPath+"GrindPlayer.swf",i=t._assetPath+"expressInstall.swf",s=this.get("contentBox"),o=s.appendChild("<div></div>"),u=t.model.preroll,a=t.model.postrolls,f=t._getPosterImage(),l=o.generateID(),c={autoPlay:t._autoplay,javascriptCallbackFunction:t._getGlobalCallback(l),bufferingOverlay:!1,initialBufferTime:3,expandedBufferTime:10,tintColor:t.tintColor,poster:f,embed:t.embed==1,showIntermediateButton:e.Vdgm.app?t.embed!=1:!1},h={wmode:"opaque"},p={allowFullScreen:!0,allowScriptAccess:"always",wmode:"opaque",name:l};this.type=="live"?(c.src=t.flashLiveStream,t.model.set("userstopped",!1)):t.f4mhost?c.src="http://"+t.f4mhost+"/api/"+n+".f4m":t.host&e.Vdgm.app?c.src="http://"+t.host+"/api/"+n+".f4m":c.src=this.getVideo("ios").videoUrls.ios;if(u!=null&&u!=undefined){var d="";t.host?u.promo_type=="channel"?d="http://"+t.host+"/api/promo-f4m/channel/preroll/"+u.channelSlug+".f4m":d="http://"+t.host+"/api/promo-f4m/video/preroll/"+t.model.slug+".f4m":d=this.getVideo("ios").videoUrls.ios,this._preroll={src:d,shown:!1,complete:!1}}if(a!=null&&a!=undefined){var v="";t.host?a.promo_type=="channel"?v="http://"+t.host+"/api/promo-f4m/channel/postroll/"+a.channelSlug+".f4m":v="http://"+t.host+"/api/promo-f4m/video/postroll/"+t.model.slug+".f4m":v=this.getVideo("ios").videoUrls.ios,this._postroll={src:v,shown:!1,complete:!1}}this.timeIterator=0,e.swfobject.embedSWF(r,l,"100%","100%","10.1.0",i,c,h,p,function(n){n.success?(t._swf=e.Node(n.ref),t.type=="live"&&t._flash_playing(null)):(o.remove(),t._renderGetFlashMessage())});if(!t._autoplay){var m=t.get("boundingBox").one(".yui3-videoplayer-content");m.addClass("icon-play vdgm-icon-play"
),t.model.images&&t.model.images[1140]&&(m.setStyle("background-image","url("+t._getPosterImage()+")"),console.log(t._getPosterImage())),t.once("play",function(n){m.setStyle("background-image","none"),m.removeClass("icon-play vdgm-icon-play"),e.later(1e3,t,t._playFlashVideo)})}},_bindFlashVideo:function(){},_playFlashVideo:function(){var t=this._swf.getDOMNode(),n=this;try{n.player&&t.getCanPlay()?t.play2():e.later(200,this,n._playFlashVideo)}catch(r){e.later(200,this,n._playFlashVideo)}},_pauseFlashVideo:function(){var e=arguments[0],t=this;if(this.type!="live"&&t.player&&t.player.getPlaying()){var n=t.player;n.pause&&n.pause(),t.isPaused=!0}},_stopFlashVideo:function(){this._pauseFlashVideo(),this._track("Stop"),this._percentPlayed=0,this.type=="live"&&this.model.set("userstopped",!0),this.fire("stop")},_removeFlashVideo:function(){this.player&&this._swf.remove(!0)},_destroyFlashVideo:function(){this.player&&this._swf.remove(!0),this.model.clear()},_renderGetFlashMessage:function(){var t=this.get("contentBox");t.appendChild(e.Node.create(n.GET_FLASH_TEMPLATE))}}),e.Vdgm.app&&e.augment(n,e.Vdgm.Logger)},"0.0.1",{requires:["node-event-html5","widget","vdgm-logr","swfobject","swf","widget-parent","widget-child"],skinnable:!0}),YUI.add("vdgmvideoplayer",function(e,t){},"0.0.1",{use:["vdgm","videomodal","videoplayer"]});
